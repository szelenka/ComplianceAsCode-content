<def-group>
  <definition class="compliance" id="installed_crunchy-data-postgres_version_supported"  version="1">
    <metadata>
      <title>Supported Version of CrunchyData Postgres Installed</title>
      <affected family="unix">
        <platform>CrunchyData Postgres</platform>
      </affected>
      <description>Use of versions of an application which are not
      supported by the vendor are not permitted. Vendors respond to
      security flaws with updates and patches. These updates are not
      available for unsupported versions which can leave the application
      vulnerable to attack.</description>
    </metadata>
    <criteria>
      <criterion comment="installed version of crunchy-data-postgres supported" test_ref="test_supported_version_of_crunchy-data-postgres" />
    </criteria>
  </definition>

{{% if pkg_system == "rpm" %}}
  <linux:rpminfo_test check="all" check_existence="any_exist" comment="Installed version of crunchy-data-postgres is greater than 14.0" id="test_supported_version_of_crunchy-data-postgres" version="1">
    <linux:object object_ref="obj_supported_version_of_crunchy-data-postgres" />
    <linux:state state_ref="state_supported_version_of_crunchy-data-postgres" />
  </linux:rpminfo_test>
  <linux:rpminfo_object id="obj_supported_version_of_crunchy-data-postgres" version="1">
    <linux:name>crunchy-data-postgres</linux:name>
  </linux:rpminfo_object>
  <linux:rpminfo_state id="state_supported_version_of_crunchy-data-postgres" version="1">
    <linux:evr operation="greater than" datatype="evr_string">14.0</linux:evr> 
  </linux:rpminfo_state>
{{% elif pkg_system == "dpkg" %}}
  <linux:dpkginfo_test check="all" check_existence="any_exist" comment="Installed version of crunchy-data-postgres is greater than 14.0" id="test_supported_version_of_crunchy-data-postgres" version="1">
    <linux:object object_ref="obj_supported_version_of_crunchy-data-postgres" />
    <linux:state state_ref="state_supported_version_of_crunchy-data-postgres" />
  </linux:dpkginfo_test>
  <linux:dpkginfo_object id="obj_supported_version_of_crunchy-data-postgres" version="1">
    <linux:name>crunchy-data-postgres</linux:name>
  </linux:dpkginfo_object>
  <linux:dpkginfo_state id="state_supported_version_of_crunchy-data-postgres" version="1">
    <linux:evr operation="greater than" datatype="evr_string">14.0</linux:evr> 
  </linux:dpkginfo_state>
{{% endif %}}

</def-group>
