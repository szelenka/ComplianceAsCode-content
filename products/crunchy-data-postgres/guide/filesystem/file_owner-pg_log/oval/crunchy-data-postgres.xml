<def-group>
  <definition class="compliance" id="file_owner-pg_log"  version="1">
    {{{ oval_metadata("This test makes sure that ${PGLOG?}/ is owned by root.") }}}
    <criteria>
      <criterion comment="Check file ownership of ${PGLOG?}" test_ref="test_file_owner-pg_log" />
    </criteria>
  </definition>

  <ind:environmentvariable58_object id="var_obj_file_owner-pg_log" version="1">
    <ind:pid xsi:nil="true" datatype="int" />
    <ind:name>PGLOG</ind:name>
  </ind:environmentvariable58_object>

  <local_variable comment="Expose path for PGLOG" datatype="string" id="var_file_owner-pg_log" version="1">
    <object_component item_field="value" object_ref="var_obj_file_owner-pg_log" />
  </local_variable>

  <unix:file_test check="all" check_existence="all_exist" comment="Test that that /usr/lib/postgresql/14/bin/postgres does exist" id="test_file_owner-pg_log" version="1">
    <unix:object object_ref="obj_file_owner-pg_log" />
    <unix:state state_ref="state_file_owner-pg_log" />
  </unix:file_test>

  <unix:file_object id="obj_file_owner-pg_log" version="1">
    <unix:path var_ref="var_file_owner-pg_log" var_check="at least one" />
    <unix:filename xsi:nil="true" />
  </unix:file_object>

  <unix:file_state id="state_file_owner-pg_log" version="1">
    <unix:user_id datatype="int">0</unix:user_id>
  </unix:file_state>

</def-group>
